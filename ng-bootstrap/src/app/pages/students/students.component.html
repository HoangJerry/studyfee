<div class="row wrapper border-bottom white-bg page-heading">
    <div class="titleLeft">
        <h2>Students Managerment</h2>
    </div>
    <div class="controllerRight">
        <button class="btn btn-w-m btn-primary btnNav" type="button" (click)="addButton.open()">Add</button>
    	<button class="btn btn-w-m btn-primary btnNav" [attr.disabled]="selected?null:''" type="button" (click)="updateButton.open()">Update</button>
    	<button class="btn btn-w-m btn-danger btnNav" (click)="deleteButton.open()" type="button">Delete</button>
    </div>
</div>

<div class="row wrapper wrapper-content animated fadeInRight">
	<div class="col-lg-12">
        <div class="ibox float-e-margins">
            <div class="ibox-title">
                <h5>Students list</h5>
              <!--   <div class="ibox-tools">
                    <a class="collapse-link">
                        <i class="fa fa-chevron-up"></i>
                    </a>
                    <a class="close-link">
                        <i class="fa fa-times"></i>
                    </a>
                </div> -->
            </div>
            <div class="ibox-content">
                <table class="table table-hover no-margins">
                    <thead>
                    <tr>
                        <th>STT</th>
                        <th>Họ và tên</th>
                        <th>Học lớp</th>
                        <th>Giáo viên</th>
                        <th>Khóa học</th>
                        <th>Ghi chú</th>
                    </tr>
                    </thead>
                    <tbody>
	                    <tr *ngFor="let student of students"  [class.active]="selected==student||inMulti(student)" (click)="onClickRow(student)" (blur)="onBlurRow()" (dblclick)="multiSelect=true;onClickRow(student)">
	                        <td>{{student.id}}</td>
	                        <td>{{student.full_name}}</td>
                            <td>{{student.study_at_class_view.class_id}}</td>
	                        <td>{{student.study_at_class_view.teacher_1_view.first_name}} {{student.study_at_class_view.teacher_1_view.last_name}} {{student.study_at_class_view.teacher_2!=null?"| "+ student.study_at_class_view.teacher_2_view.first_name + student.study_at_class_view.teacher_2_view.last_name:""}}</td>
	                        <td>{{student.type_of_class}}</td>
	                        <td></td>
	                    </tr>
                    </tbody>
                </table>
            </div>

            <div class="ibox-content">
                <div class="btn-group">
                    <button type="button" class="btn btn-white" [attr.disabled]="preBtn==null" (click)="currentPage=currentPage-1;getStudents((this.currentPage-1)*this.numberPerPage);"><i class="fa fa-chevron-left"></i></button>
                    <button class="btn btn-white" (click)="currentPage=page;getStudents((this.currentPage-1)*this.numberPerPage);" [class.active]="page==currentPage" *ngFor="let page of pages">{{page}}</button>
                    <button type="button" class="btn btn-white" (click)="currentPage=currentPage+1;getStudents((this.currentPage-1)*this.numberPerPage);" [attr.disabled]="nextBtn==null"><i class="fa fa-chevron-right"></i> </button>
                </div>
            </div>

            <div *ngIf="multiSelect" style="position: absolute; top: 20px; right:30px;">
                <button class="btn btn-default btn-circle btn-lg" type="button" (click)="turnOffMultiSelect()"><i class="fa fa-times"></i></button>  
            </div>
       
        </div>
    </div>
</div>

<modal #addButton modalClass="modal-lg" class="addModal">
    <modal-header>
        <h1>Nhập thông tin</h1>
    </modal-header>
    <modal-content>
        <div class="form-group">
            <label>Mã số HS *</label>
            <input type="text" name="student_id" value="" class="d-inline-block " [(ngModel)]="new_student.student_id" placeholder="Mã số HS">
        </div>
        <div class="form-group">
            <label>Họ tên *</label>
            <input type="text" name="first_name" value="" class="d-inline-block " [(ngModel)]="new_student.first_name" placeholder="Họ lót">
            <input type="text" name="name" value="" class="d-inline-block " [(ngModel)]="new_student.last_name" placeholder="Tên">   
        </div>
        <div class="form-group">
            <label>Năm sinh</label>
            <input type="date" name="name" value="" class="d-inline-block " [(ngModel)]="new_student.date_of_bidth" placeholder="Năm sinh">  
        </div>
        <div class="form-group">
            <label>Học lớp *</label>
            <select name="select" [(ngModel)] = "new_student.study_at_class">
                <option  *ngFor="let select of selectClass"  value="{{select.id}}" >{{select.class_id}}</option>
            </select>
        </div>
        <div class="form-group">
            <label>Trường *</label>
            <select name="select" [(ngModel)] = "new_student.school">
                <option  *ngFor="let select of selectSchool"  value="{{select.id}}" >{{select.name}}</option>
            </select>
        </div>
        <div class="form-group">
            <label>Họ tên cha mẹ</label>
            <input type="text" name="parent_first_name" value="" class="d-inline-block " [(ngModel)]="new_student.parent_first_name" placeholder="Họ lót">
            <input type="text" name="parent_last_name" value="" class="d-inline-block " [(ngModel)]="new_student.parent_last_name" placeholder="Tên">   
        </div>
        <div class="form-group">
            <label>Điện thoại liên lạc</label>
            <input type="text" name="parent_phone" value="" class="d-inline-block " [(ngModel)]="new_student.parent_phone" placeholder="0913 748 987">
        </div>
        <div class="form-group">
            <label>Email</label>
            <input type="email" name="parent_email" value="" class="d-inline-block " [(ngModel)]="new_student.parent_email" placeholder="Email">
        </div>
    </modal-content>
    <modal-footer>
        <button class="btn btn-w-m btn-primary" (click)="onClickSave();">save</button>
        <button class="btn btn-w-m btn-default" id="btnCloseAddModal" (click)="addButton.close()">close</button>
    </modal-footer>
</modal>

<modal #updateButton modalClass="modal-lg" class="addModal">
    <modal-header>
        <h1>Cập nhật thông tin</h1>
    </modal-header>
    <modal-content *ngIf="selected">
        <div class="form-group">
            <label>Mã số HS *</label>
            <input type="text" name="student_id" value="" class="d-inline-block " [(ngModel)]="selected.student_id" placeholder="Mã số HS">
        </div>
        <div class="form-group">
            <label>Họ tên *</label>
            <input type="text" name="first_name" value="" class="d-inline-block " [(ngModel)]="selected.first_name" placeholder="Họ lót">
            <input type="text" name="name" value="" class="d-inline-block " [(ngModel)]="selected.last_name" placeholder="Tên">   
        </div>
        <div class="form-group">
            <label>Năm sinh</label>
            <input type="date" name="name" value="" class="d-inline-block " [(ngModel)]="selected.date_of_bidth" placeholder="Năm sinh">  
        </div>
        <div class="form-group">
            <label>Học lớp *</label>
            <select name="select" [(ngModel)] = "selected.study_at_class">
                <option  *ngFor="let select of selectClass"  value="{{select.id}}" >{{select.class_id}}</option>
            </select>
        </div>
        <div class="form-group">
            <label>Trường *</label>
            <select name="select" [(ngModel)] = "selected.school">
                <option  *ngFor="let select of selectSchool"  value="{{select.id}}" >{{select.name}}</option>
            </select>
        </div>
        <div class="form-group">
            <label>Họ tên cha mẹ</label>
            <input type="text" name="parent_first_name" value="" class="d-inline-block " [(ngModel)]="selected.parent_first_name" placeholder="Họ lót">
            <input type="text" name="parent_last_name" value="" class="d-inline-block " [(ngModel)]="selected.parent_last_name" placeholder="Tên">   
        </div>
        <div class="form-group">
            <label>Điện thoại liên lạc</label>
            <input type="text" name="parent_phone" value="" class="d-inline-block " [(ngModel)]="selected.parent_phone" placeholder="0913 748 987">
        </div>
        <div class="form-group">
            <label>Email</label>
            <input type="email" name="parent_email" value="" class="d-inline-block " [(ngModel)]="selected.parent_email" placeholder="Email">
        </div>
    </modal-content>
    <modal-footer>
        <button class="btn btn-w-m btn-primary" (click)="onClickUpdate();">save</button>
        <button class="btn btn-w-m btn-default" id="btnCloseUpdateModal" (click)="updateButton.close()">close</button>
    </modal-footer>
</modal>


<modal #deleteButton modalClass="modal-md">
    <modal-header>
        <h1>Xác nhận</h1>
    </modal-header>
    <modal-content>
        <div *ngIf="selected">
            Có đồng ý xóa học sinh "{{selected.full_name}}" này không?
        </div>
        <div *ngIf="selected==null&&multiSelect==false">
            Chọn ít nhất 1 học sinh để xóa
        </div>
        <div *ngIf="multiSelect&&multiSelectedList">
            Có đồng ý xóa {{multiSelectedList.length}} học sinh này không?
        </div>

    </modal-content>
    <modal-footer>
        <div *ngIf="selected||(multiSelect&&multiSelectedList)">
            <button class="btn btn-w-m btn-primary" (click)="onClickDelete();deleteButton.close();">Yes</button>
            <button class="btn btn-w-m btn-default" (click)="deleteButton.close()">No</button>
        </div>
    </modal-footer>
</modal>